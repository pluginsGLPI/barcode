<HTML>
<HEAD>
<META HTTP-EQUIV="Content-Type" CONTENT="text/html; charset=ISO-8859-1">
<TITLE>Tableaux</TITLE>
<LINK TYPE="text/css" REL="stylesheet" HREF="../fpdf.css">
</HEAD>
<BODY>
<H2>Tableaux</H2>
Ce tutoriel montre comment réaliser des tableaux simplement.
<BR>
<BR>
<TABLE WIDTH="100%" STYLE="color:#4040C0; border-style:ridge" BORDERCOLORLIGHT="#B0B0E0" BORDERCOLORDARK="#000000" BORDER="2" CELLPADDING=6 CELLSPACING=0 BGCOLOR="#F0F5FF"><TR><TD style="border-width:0px">
<NOBR><code><font color="#000000">
&lt;?php<br><font class="kw">require(</font><font class="str">'fpdf.php'</font><font class="kw">);<br><br>class </font>PDF <font class="kw">extends </font>FPDF<br><font class="kw">{<br></font><font class="cmt">//Chargement des données<br></font><font class="kw">function </font>LoadData<font class="kw">(</font>$file<font class="kw">)<br>{<br>&nbsp;&nbsp;&nbsp;&nbsp;</font><font class="cmt">//Lecture des lignes du fichier<br>&nbsp;&nbsp;&nbsp;&nbsp;</font>$lines<font class="kw">=</font>file<font class="kw">(</font>$file<font class="kw">);<br>&nbsp;&nbsp;&nbsp;&nbsp;</font>$data<font class="kw">=array();<br>&nbsp;&nbsp;&nbsp;&nbsp;foreach(</font>$lines <font class="kw">as </font>$line<font class="kw">)<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</font>$data<font class="kw">[]=</font>explode<font class="kw">(</font><font class="str">';'</font><font class="kw">,</font>chop<font class="kw">(</font>$line<font class="kw">));<br>&nbsp;&nbsp;&nbsp;&nbsp;return </font>$data<font class="kw">;<br>}<br><br></font><font class="cmt">//Tableau simple<br></font><font class="kw">function </font>BasicTable<font class="kw">(</font>$header<font class="kw">,</font>$data<font class="kw">)<br>{<br>&nbsp;&nbsp;&nbsp;&nbsp;</font><font class="cmt">//En-tête<br>&nbsp;&nbsp;&nbsp;&nbsp;</font><font class="kw">foreach(</font>$header <font class="kw">as </font>$col<font class="kw">)<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</font>$<font class="kw">this-&gt;</font>Cell<font class="kw">(</font>40<font class="kw">,</font>7<font class="kw">,</font>$col<font class="kw">,</font>1<font class="kw">);<br>&nbsp;&nbsp;&nbsp;&nbsp;</font>$<font class="kw">this-&gt;</font>Ln<font class="kw">();<br>&nbsp;&nbsp;&nbsp;&nbsp;</font><font class="cmt">//Données<br>&nbsp;&nbsp;&nbsp;&nbsp;</font><font class="kw">foreach(</font>$data <font class="kw">as </font>$row<font class="kw">)<br>&nbsp;&nbsp;&nbsp;&nbsp;{<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;foreach(</font>$row <font class="kw">as </font>$col<font class="kw">)<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</font>$<font class="kw">this-&gt;</font>Cell<font class="kw">(</font>40<font class="kw">,</font>6<font class="kw">,</font>$col<font class="kw">,</font>1<font class="kw">);<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</font>$<font class="kw">this-&gt;</font>Ln<font class="kw">();<br>&nbsp;&nbsp;&nbsp;&nbsp;}<br>}<br><br></font><font class="cmt">//Tableau amélioré<br></font><font class="kw">function </font>ImprovedTable<font class="kw">(</font>$header<font class="kw">,</font>$data<font class="kw">)<br>{<br>&nbsp;&nbsp;&nbsp;&nbsp;</font><font class="cmt">//Largeurs des colonnes<br>&nbsp;&nbsp;&nbsp;&nbsp;</font>$w<font class="kw">=array(</font>40<font class="kw">,</font>35<font class="kw">,</font>45<font class="kw">,</font>40<font class="kw">);<br>&nbsp;&nbsp;&nbsp;&nbsp;</font><font class="cmt">//En-tête<br>&nbsp;&nbsp;&nbsp;&nbsp;</font><font class="kw">for(</font>$i<font class="kw">=</font>0<font class="kw">;</font>$i<font class="kw">&lt;</font>count<font class="kw">(</font>$header<font class="kw">);</font>$i<font class="kw">++)<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</font>$<font class="kw">this-&gt;</font>Cell<font class="kw">(</font>$w<font class="kw">[</font>$i<font class="kw">],</font>7<font class="kw">,</font>$header<font class="kw">[</font>$i<font class="kw">],</font>1<font class="kw">,</font>0<font class="kw">,</font><font class="str">'C'</font><font class="kw">);<br>&nbsp;&nbsp;&nbsp;&nbsp;</font>$<font class="kw">this-&gt;</font>Ln<font class="kw">();<br>&nbsp;&nbsp;&nbsp;&nbsp;</font><font class="cmt">//Données<br>&nbsp;&nbsp;&nbsp;&nbsp;</font><font class="kw">foreach(</font>$data <font class="kw">as </font>$row<font class="kw">)<br>&nbsp;&nbsp;&nbsp;&nbsp;{<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</font>$<font class="kw">this-&gt;</font>Cell<font class="kw">(</font>$w<font class="kw">[</font>0<font class="kw">],</font>6<font class="kw">,</font>$row<font class="kw">[</font>0<font class="kw">],</font><font class="str">'LR'</font><font class="kw">);<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</font>$<font class="kw">this-&gt;</font>Cell<font class="kw">(</font>$w<font class="kw">[</font>1<font class="kw">],</font>6<font class="kw">,</font>$row<font class="kw">[</font>1<font class="kw">],</font><font class="str">'LR'</font><font class="kw">);<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</font>$<font class="kw">this-&gt;</font>Cell<font class="kw">(</font>$w<font class="kw">[</font>2<font class="kw">],</font>6<font class="kw">,</font>number_format<font class="kw">(</font>$row<font class="kw">[</font>2<font class="kw">],</font>0<font class="kw">,</font><font class="str">','</font><font class="kw">,</font><font class="str">' '</font><font class="kw">),</font><font class="str">'LR'</font><font class="kw">,</font>0<font class="kw">,</font><font class="str">'R'</font><font class="kw">);<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</font>$<font class="kw">this-&gt;</font>Cell<font class="kw">(</font>$w<font class="kw">[</font>3<font class="kw">],</font>6<font class="kw">,</font>number_format<font class="kw">(</font>$row<font class="kw">[</font>3<font class="kw">],</font>0<font class="kw">,</font><font class="str">','</font><font class="kw">,</font><font class="str">' '</font><font class="kw">),</font><font class="str">'LR'</font><font class="kw">,</font>0<font class="kw">,</font><font class="str">'R'</font><font class="kw">);<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</font>$<font class="kw">this-&gt;</font>Ln<font class="kw">();<br>&nbsp;&nbsp;&nbsp;&nbsp;}<br>&nbsp;&nbsp;&nbsp;&nbsp;</font><font class="cmt">//Trait de terminaison<br>&nbsp;&nbsp;&nbsp;&nbsp;</font>$<font class="kw">this-&gt;</font>Cell<font class="kw">(</font>array_sum<font class="kw">(</font>$w<font class="kw">),</font>0<font class="kw">,</font><font class="str">''</font><font class="kw">,</font><font class="str">'T'</font><font class="kw">);<br>}<br><br></font><font class="cmt">//Tableau coloré<br></font><font class="kw">function </font>FancyTable<font class="kw">(</font>$header<font class="kw">,</font>$data<font class="kw">)<br>{<br>&nbsp;&nbsp;&nbsp;&nbsp;</font><font class="cmt">//Couleurs, épaisseur du trait et police grasse<br>&nbsp;&nbsp;&nbsp;&nbsp;</font>$<font class="kw">this-&gt;</font>SetFillColor<font class="kw">(</font>255<font class="kw">,</font>0<font class="kw">,</font>0<font class="kw">);<br>&nbsp;&nbsp;&nbsp;&nbsp;</font>$<font class="kw">this-&gt;</font>SetTextColor<font class="kw">(</font>255<font class="kw">);<br>&nbsp;&nbsp;&nbsp;&nbsp;</font>$<font class="kw">this-&gt;</font>SetDrawColor<font class="kw">(</font>128<font class="kw">,</font>0<font class="kw">,</font>0<font class="kw">);<br>&nbsp;&nbsp;&nbsp;&nbsp;</font>$<font class="kw">this-&gt;</font>SetLineWidth<font class="kw">(</font>.3<font class="kw">);<br>&nbsp;&nbsp;&nbsp;&nbsp;</font>$<font class="kw">this-&gt;</font>SetFont<font class="kw">(</font><font class="str">''</font><font class="kw">,</font><font class="str">'B'</font><font class="kw">);<br>&nbsp;&nbsp;&nbsp;&nbsp;</font><font class="cmt">//En-tête<br>&nbsp;&nbsp;&nbsp;&nbsp;</font>$w<font class="kw">=array(</font>40<font class="kw">,</font>35<font class="kw">,</font>45<font class="kw">,</font>40<font class="kw">);<br>&nbsp;&nbsp;&nbsp;&nbsp;for(</font>$i<font class="kw">=</font>0<font class="kw">;</font>$i<font class="kw">&lt;</font>count<font class="kw">(</font>$header<font class="kw">);</font>$i<font class="kw">++)<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</font>$<font class="kw">this-&gt;</font>Cell<font class="kw">(</font>$w<font class="kw">[</font>$i<font class="kw">],</font>7<font class="kw">,</font>$header<font class="kw">[</font>$i<font class="kw">],</font>1<font class="kw">,</font>0<font class="kw">,</font><font class="str">'C'</font><font class="kw">,</font>1<font class="kw">);<br>&nbsp;&nbsp;&nbsp;&nbsp;</font>$<font class="kw">this-&gt;</font>Ln<font class="kw">();<br>&nbsp;&nbsp;&nbsp;&nbsp;</font><font class="cmt">//Restauration des couleurs et de la police<br>&nbsp;&nbsp;&nbsp;&nbsp;</font>$<font class="kw">this-&gt;</font>SetFillColor<font class="kw">(</font>224<font class="kw">,</font>235<font class="kw">,</font>255<font class="kw">);<br>&nbsp;&nbsp;&nbsp;&nbsp;</font>$<font class="kw">this-&gt;</font>SetTextColor<font class="kw">(</font>0<font class="kw">);<br>&nbsp;&nbsp;&nbsp;&nbsp;</font>$<font class="kw">this-&gt;</font>SetFont<font class="kw">(</font><font class="str">''</font><font class="kw">);<br>&nbsp;&nbsp;&nbsp;&nbsp;</font><font class="cmt">//Données<br>&nbsp;&nbsp;&nbsp;&nbsp;</font>$fill<font class="kw">=</font>0<font class="kw">;<br>&nbsp;&nbsp;&nbsp;&nbsp;foreach(</font>$data <font class="kw">as </font>$row<font class="kw">)<br>&nbsp;&nbsp;&nbsp;&nbsp;{<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</font>$<font class="kw">this-&gt;</font>Cell<font class="kw">(</font>$w<font class="kw">[</font>0<font class="kw">],</font>6<font class="kw">,</font>$row<font class="kw">[</font>0<font class="kw">],</font><font class="str">'LR'</font><font class="kw">,</font>0<font class="kw">,</font><font class="str">'L'</font><font class="kw">,</font>$fill<font class="kw">);<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</font>$<font class="kw">this-&gt;</font>Cell<font class="kw">(</font>$w<font class="kw">[</font>1<font class="kw">],</font>6<font class="kw">,</font>$row<font class="kw">[</font>1<font class="kw">],</font><font class="str">'LR'</font><font class="kw">,</font>0<font class="kw">,</font><font class="str">'L'</font><font class="kw">,</font>$fill<font class="kw">);<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</font>$<font class="kw">this-&gt;</font>Cell<font class="kw">(</font>$w<font class="kw">[</font>2<font class="kw">],</font>6<font class="kw">,</font>number_format<font class="kw">(</font>$row<font class="kw">[</font>2<font class="kw">],</font>0<font class="kw">,</font><font class="str">','</font><font class="kw">,</font><font class="str">' '</font><font class="kw">),</font><font class="str">'LR'</font><font class="kw">,</font>0<font class="kw">,</font><font class="str">'R'</font><font class="kw">,</font>$fill<font class="kw">);<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</font>$<font class="kw">this-&gt;</font>Cell<font class="kw">(</font>$w<font class="kw">[</font>3<font class="kw">],</font>6<font class="kw">,</font>number_format<font class="kw">(</font>$row<font class="kw">[</font>3<font class="kw">],</font>0<font class="kw">,</font><font class="str">','</font><font class="kw">,</font><font class="str">' '</font><font class="kw">),</font><font class="str">'LR'</font><font class="kw">,</font>0<font class="kw">,</font><font class="str">'R'</font><font class="kw">,</font>$fill<font class="kw">);<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</font>$<font class="kw">this-&gt;</font>Ln<font class="kw">();<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</font>$fill<font class="kw">=!</font>$fill<font class="kw">;<br>&nbsp;&nbsp;&nbsp;&nbsp;}<br>&nbsp;&nbsp;&nbsp;&nbsp;</font>$<font class="kw">this-&gt;</font>Cell<font class="kw">(</font>array_sum<font class="kw">(</font>$w<font class="kw">),</font>0<font class="kw">,</font><font class="str">''</font><font class="kw">,</font><font class="str">'T'</font><font class="kw">);<br>}<br>}<br><br></font>$pdf<font class="kw">=new </font>PDF<font class="kw">();<br></font><font class="cmt">//Titres des colonnes<br></font>$header<font class="kw">=array(</font><font class="str">'Pays'</font><font class="kw">,</font><font class="str">'Capitale'</font><font class="kw">,</font><font class="str">'Superficie (km²)'</font><font class="kw">,</font><font class="str">'Pop. (milliers)'</font><font class="kw">);<br></font><font class="cmt">//Chargement des données<br></font>$data<font class="kw">=</font>$pdf<font class="kw">-&gt;</font>LoadData<font class="kw">(</font><font class="str">'pays.txt'</font><font class="kw">);<br></font>$pdf<font class="kw">-&gt;</font>SetFont<font class="kw">(</font><font class="str">'Arial'</font><font class="kw">,</font><font class="str">''</font><font class="kw">,</font>14<font class="kw">);<br></font>$pdf<font class="kw">-&gt;</font>AddPage<font class="kw">();<br></font>$pdf<font class="kw">-&gt;</font>BasicTable<font class="kw">(</font>$header<font class="kw">,</font>$data<font class="kw">);<br></font>$pdf<font class="kw">-&gt;</font>AddPage<font class="kw">();<br></font>$pdf<font class="kw">-&gt;</font>ImprovedTable<font class="kw">(</font>$header<font class="kw">,</font>$data<font class="kw">);<br></font>$pdf<font class="kw">-&gt;</font>AddPage<font class="kw">();<br></font>$pdf<font class="kw">-&gt;</font>FancyTable<font class="kw">(</font>$header<font class="kw">,</font>$data<font class="kw">);<br></font>$pdf<font class="kw">-&gt;</font>Output<font class="kw">();<br></font>?&gt;
</font>
</code></NOBR></TD></TR></TABLE><P></P>
<SCRIPT>
<!--
if(document.location.href.indexOf('http:')==0)
{
document.write("<P CLASS='demo'><A HREF='tuto5.php' TARGET='_blank' CLASS='demo'>[Démo]</A></P>");
}
//-->
</SCRIPT>
Un tableau n'étant qu'un ensemble de cellules, il est naturel de les construire à partir de
ces dernières. Le premier est réalisé de la manière la plus élémentaire qui soit : de simples
cellules encadrées, toutes de la même taille et alignées à gauche. Le résultat est
rudimentaire mais très rapide à obtenir.
<BR>
<BR>
Le deuxième tableau apporte quelques améliorations : chaque colonne a sa propre largeur, les
titres sont centrés et les nombres cadrés à droite. De plus, les traits horizontaux ont été
enlevés. Ceci est réalisé grâce au paramètre <TT>border</TT> de la méthode <A HREF='../doc/cell.htm'>Cell()</A>, qui
permet de spécifier quels bords de la cellule doivent être tracés. Dans le cas présent, on
désire les bords gauches (<TT>L</TT>) et droits (<TT>R</TT>). Reste le problème du trait
horizontal final pour refermer le tableau. Il y a deux possibilités : soit tester dans la
boucle si on se trouve sur la dernière ligne, auquel cas on utilise <TT>LRB</TT> pour le
paramètre <TT>border</TT> ; soit, comme c'est fait ici, ajouter le trait une fois la boucle
terminée.
<BR>
<BR>
Le troisième tableau est semblable au deuxième mais utilise des couleurs. Il suffit pour cela
de préciser les couleurs de fond, de texte et de trait souhaitées. L'alternance de couleur
pour les lignes est obtenue en utilisant des cellules à fond alternativement coloré et
transparent.
</BODY>
</HTML>
